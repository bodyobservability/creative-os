{
  "schema_version": 1,
  "run_id": "verify_abi_v1",
  "mode": "apply",
  "targets": {
    "os": "macos",
    "ableton": "12.3",
    "plugin_format_preference": [
      "au",
      "vst3"
    ]
  },
  "anchors": {
    "pack_id": "ableton12_3_default",
    "min_score": 0.9
  },
  "ops": [
    {
      "id": "verify_tracks_present",
      "do": {
        "type": "sleep",
        "ms": 100
      },
      "post": [
        {
          "type": "ui_text_contains",
          "region": "tracks.list",
          "text": "Vox",
          "min_conf": 0.7
        },
        {
          "type": "ui_text_contains",
          "region": "tracks.list",
          "text": "Serum",
          "min_conf": 0.7
        }
      ],
      "retries": 1,
      "timeout_ms": 5000,
      "notes": "Confirms Vox + SerumLead exist in track headers."
    },
    {
      "id": "verify_vox_chain",
      "do": {
        "type": "click_ocr_match",
        "region": "tracks.list",
        "match": {
          "text": "Vox",
          "mode": "contains",
          "min_conf": 0.75
        }
      },
      "post": [
        {
          "type": "ui_text_contains",
          "region": "device.chain",
          "text": "EQ Eight",
          "min_conf": 0.7
        },
        {
          "type": "ui_text_contains",
          "region": "device.chain",
          "text": "Compressor",
          "min_conf": 0.7
        },
        {
          "type": "ui_text_contains",
          "region": "device.chain",
          "text": "Limiter",
          "min_conf": 0.7
        },
        {
          "type": "ui_text_contains",
          "region": "device.chain",
          "text": "Utility",
          "min_conf": 0.7
        }
      ],
      "retries": 2,
      "timeout_ms": 8000,
      "notes": "Confirms Vox chain contains stock safety devices."
    },
    {
      "id": "verify_serum_chain",
      "do": {
        "type": "click_ocr_match",
        "region": "tracks.list",
        "match": {
          "text": "Serum",
          "mode": "contains",
          "min_conf": 0.75
        }
      },
      "post": [
        {
          "type": "ui_text_contains",
          "region": "device.chain",
          "text": "Serum",
          "min_conf": 0.65
        },
        {
          "type": "ui_text_contains",
          "region": "device.chain",
          "text": "EQ Eight",
          "min_conf": 0.7
        },
        {
          "type": "ui_text_contains",
          "region": "device.chain",
          "text": "Utility",
          "min_conf": 0.7
        },
        {
          "type": "ui_text_contains",
          "region": "device.chain",
          "text": "Limiter",
          "min_conf": 0.7
        }
      ],
      "retries": 2,
      "timeout_ms": 8000,
      "notes": "Confirms SerumLead chain contains Serum + stock safety devices."
    },
    {
      "id": "open_serum_window_and_verify",
      "do": {
        "type": "open_plugin_window",
        "plugin_name": "Serum",
        "device_chain_text": "Serum",
        "open_method": "anchor_button"
      },
      "post": [
        {
          "type": "ui_anchor_present",
          "anchor_id": "serum.window.signature",
          "min_score": 0.9
        }
      ],
      "retries": 2,
      "timeout_ms": 12000,
      "notes": "Confirms Serum window can open and signature anchor is present (requires OpenCV build + anchors)."
    }
  ]
}